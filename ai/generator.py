import random
from collections import deque

class GirlReplyGenerator:
    def __init__(self, memory_size=45):
        self.recent = deque(maxlen=memory_size)

        self.female_parts = [
            "ржЧрзБржж", "ржнрзЛржжрж╛", "ржкрж╛ржЫрж╛", "ржЧрж╛ржБржбрж╝", "ржжрзБржз", "ржмрзЛржБржЯрж╛", "ржирж┐ржкрж▓",
            "ржХрзНрж▓рж┐ржЯ", "ржорзБржЦ", "ржЧрж▓рж╛", "ржЬрж┐ржн", "ржарзЛржБржЯ", "рж╕рж╛ржУрж╕рж╛", "ржШрж╛ржбрж╝", "ржХрзЛржорж░", "ржЙрж░рзБ"
        ]

        self.male_parts = [
            "ржзрзЛржи", "ржмрж╛ржбрж╝рж╛", "рж▓рж┐ржЩрзНржЧ", "ржорзЛржЯрж╛ ржзрзЛржи", "ржмржбрж╝ ржмрж╛ржбрж╝рж╛", "ржХржбрж╝рж╛ ржзрзЛржи",
            "ржЧрж░ржо рж▓рж┐ржЩрзНржЧ", "рж▓ржорзНржмрж╛ ржмрж╛ржбрж╝рж╛", "ржлрзЛрж▓рж╛ ржзрзЛржи", "рж╢ржХрзНржд ржмрж╛ржбрж╝рж╛", "ржХрж▓рж╛", "ржорзЗрж╢рж┐ржи",
        ]

        self.begging = [
            "ржкрзНрж▓рж┐ржЬ", "ржжржпрж╝рж╛ ржХрж░рзЗ", "ржЖрж░ рж╕рж╣рзНржп рж╣ржЪрзНржЫрзЗ ржирж╛", "ржЖржорж┐ ржХрж╛ржБржкржЫрж┐",
            "ржПржЦржиржЗ ржЪрж╛ржЗ", "ржЖржорж╛рж░ ржзрзИрж░рзНржп рж╢рзЗрж╖", "ржЖржорж╛ржХрзЗ ржирж╖рзНржЯ ржХрж░рзЗ ржжрж╛ржУ",
            "ржЖржорж┐ рждрзЛрж░ ржжрж╛рж╕рзА", "ржпрж╛ ржЦрзБрж╢рж┐ ржХрж░ ржЖржорж╛рж░ рж╕рж╛ржерзЗ", "ржЖржорж╛рж░ ржнрж┐рждрж░рзЗ ржЪрж╛ржЗ",
            "ржкрзНрж▓рж┐ржЬ ржжржпрж╝рж╛ ржХрж░рзЗ", "ржЖржорж┐ ржкрж╛ржЧрж▓ рж╣ржпрж╝рзЗ ржпрж╛ржЪрзНржЫрж┐", "ржЖрж░ ржерж╛ржХрждрзЗ ржкрж╛рж░ржЫрж┐ ржирж╛"
        ]

        self.condition = [
            "ржнрж┐ржЬрзЗ ржЧрзЗржЫрзЗ", "ржПржХржжржо рждрзИрж░рж┐", "ржЬрзНржмрж▓ржЫрзЗ", "ржлрзБрж▓рзЗ ржЙржарзЗржЫрзЗ",
            "ржХрж╛ржБржкржЫрзЗ", "ржЖржЧрзБржи рж╣ржпрж╝рзЗ ржЖржЫрзЗ", "рж░рж╕рзЗ ржнрж░рж╛", "ржЯрж╛ржЗржЯ рж╣ржпрж╝рзЗ ржЧрзЗржЫрзЗ",
            "ржлрж╛ржБржХрж╛ рж▓рж╛ржЧржЫрзЗ", "ржЦрзБржм ржЧрж░ржо", "ржкрзБрж░рзЛ ржнрж┐ржЬрзЗ", "ржЖржорж╛рж░ ржнрж┐рждрж░рзЗ ржЖржЧрзБржи"
        ]

        self.action_bases = [
            "ржЬрзЛрж░рзЗ ржЬрзЛрж░рзЗ ржЪрзЛржж", "ржЧржнрзАрж░рзЗ ржарзЗрж▓рзЗ ржжрзЗ", "ржкрзБрж░рзЛржЯрж╛ ржврзБржХрж┐ржпрж╝рзЗ ржжрзЗ",
            "ржЖрж╕рзНрждрзЗ ржЖрж╕рзНрждрзЗ ржнрж░", "ржЪрзБрж▓ ржзрж░рзЗ ржорж╛рж░", "ржерж╛ржкрзНржкржбрж╝ ржорзЗрж░рзЗ ржЪрзЛржж",
            "ржЬрзЛрж░рзЗ ржарж╛ржк ржжрзЗ", "ржЧржнрзАрж░рзЗ ржЧржнрзАрж░рзЗ ржврзЛржХрж╛", "ржкрзБрж░рзЛржЯрж╛ ржнрж░рзЗ ржжрзЗ",
            "ржЪрзБрж╖рждрзЗ ржЪрзБрж╖рждрзЗ ржЦрзЗрж▓рж╛", "ржЬрж┐ржн ржжрж┐ржпрж╝рзЗ ржЪрж╛ржЯрж╛", "ржорзБржЦрзЗ ржирж┐ржпрж╝рзЗ ржЧржнрзАрж░рзЗ",
            "ржЖржЩрзБрж▓ ржжрж┐ржпрж╝рзЗ ржЦрзЗрж▓рж╛", "ржжрзБржз ржЪрзЗржкрзЗ ржзрж░рзЗ ржЪрзЛржжрзЛ", "ржкрж╛ржЫрж╛ржпрж╝ ржЬрзЛрж░рзЗ ржЪрзЛржжрж╛ ржорж╛рж░рзЛ",
            "ржЬрзЛрж░рзЗ ржЬрзЛрж░рзЗ ржарж╛ржкрж╛", "ржЧрж▓рж╛ржпрж╝ ржврзБржХрж┐ржпрж╝рзЗ ржжрзЗ", "ржжрзБржзрзЗ ржЪрзЗржкрзЗ ржзрж░"
        ]

        self.action_patterns = [
            "{action} ржХрж░рзЗ ржжрзЗ",
            "{action} ржЖржорж╛рж░ {part}-ржП",
            "ржЖржорж╛рж░ {part}-ржП {action}",
            "{action} ржЖржорж╛ржХрзЗ",
            "ржЖржорж╛рж░ {part} {action}",
            "{action} ржжрж┐ржпрж╝рзЗ ржнрж░рзЗ ржжрзЗ ржЖржорж╛ржХрзЗ",
            "рждрзЛрж░ {dick} ржжрж┐ржпрж╝рзЗ {action}"
        ]

        self.emojis = [
            "ЁЯе╡ЁЯТж", "ЁЯНЖЁЯФе", "ЁЯШнЁЯНС", "ЁЯСЕЁЯТж", "ЁЯе║ЁЯФе", "ЁЯддЁЯНЖ", "ЁЯШИЁЯТжЁЯНС",
            "ЁЯТжЁЯе╡ЁЯНЖ", "ЁЯФеЁЯШйЁЯТж", "ЁЯНСЁЯе┤ЁЯТж", "ЁЯСДЁЯФеЁЯТж", "ЁЯШПЁЯНЖЁЯТж", "ЁЯе╡ЁЯНСЁЯФе",
            "ЁЯНЖЁЯТжЁЯНС", "ЁЯШ│ЁЯТжЁЯФе", "ЁЯддЁЯе╡", "ЁЯНСЁЯТжЁЯШИ", "ЁЯФеЁЯНЖЁЯТж", "ЁЯе┤ЁЯТжЁЯНС"
        ]

    def generate(self):
        for _ in range(20):
            part = random.choice(self.female_parts)
            dick = random.choice(self.male_parts)
            cond = random.choice(self.condition)
            beg = random.choice(self.begging)
            action_base = random.choice(self.action_bases)
            pattern = random.choice(self.action_patterns)
            emo = random.choice(self.emojis)

            if random.random() < 0.7:
                action = f"рждрзЛрж░ {dick} ржжрж┐ржпрж╝рзЗ {action_base}"
            else:
                action = action_base

            middle = pattern.format(action=action, part=part, dick=dick)

            reply = f"ржЖржорж╛рж░ {part}ржЯрж╛ {cond}... {beg} {middle} {emo}"

            if not self._too_similar(reply):
                self.recent.append(reply)
                return reply

        # ржлрж▓ржмрзНржпрж╛ржХ
        return f"ржЖрж░ ржкрж╛рж░ржЫрж┐ ржирж╛... ржПржЦржиржЗ ржЖржорж╛рж░ {random.choice(self.female_parts)} ржнрж░рзЗ ржжрзЗ {random.choice(self.emojis)}"

    def _too_similar(self, text):
        if not self.recent:
            return False

        words_new = set(text.lower().split())
        for old in self.recent:
            words_old = set(old.lower().split())
            if len(words_new & words_old) >= 8:
                return True
        return False


# ржмрзНржпржмрж╣рж╛рж░рзЗрж░ ржЙржжрж╛рж╣рж░ржг (ржПржЗ рж▓рж╛ржЗржиржЧрзБрж▓рзЛ ржЪрж╛ржЗрж▓рзЗ ржорзБржЫрзЗ ржлрзЗрж▓рждрзЗ ржкрж╛рж░рзЛ)
# generator = GirlReplyGenerator()
# print(generator.generate())
